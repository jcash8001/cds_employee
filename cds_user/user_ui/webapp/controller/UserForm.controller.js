sap.ui.define([
	"sap/ui/core/mvc/Controller",
	"sap/m/MessageBox"
], function (Controller) {
	"use strict";
	return Controller.extend("user_ui.user_ui.controller.UserForm", {
		onInit: function () {},
		/**
		 *@memberOf user_ui.user_ui.controller.UserForm
		 */
		onCreate: function (oEvent) {
			//This code was generated by the layout editor.
			var oLocal = this.getView().getModel("local");
			var oService = this.getView().getModel();
			var oBundle = this.getView().getModel("i18n");
			var oNewUser = oLocal.getProperty("/User");
			oService.create("/Users", oNewUser, {
				success: function () {
					sap.m.MessageBox.alert(oBundle.getProperty("createSuccessMessage"));
				},
				error: function (oError) {
					var response = JSON.parse(oError.responseText);
					var errorMessage = response.error.message.value;
					sap.m.MessageBox.alert(oBundle.getProperty("createErrorMessage") + errorMessage);
				}
			});
		},
		/**
		 *@memberOf user_ui.user_ui.controller.UserForm
		 */
		onDelete: function (oEvent) {
			//This code was generated by the layout editor.
			var oLocal = this.getView().getModel("local");
			var oService = this.getView().getModel();
			var oBundle = this.getView().getModel("i18n");
			
			var path = oLocal.getProperty("/SelectedUserPath");
			if (path === "") {
				sap.m.MessageBox.alert(oBundle.getProperty("deleteNoSelectionMessage"));
			} else {
				oService.remove(path, {
					success: function() {
						sap.m.MessageBox.alert(oBundle.getProperty("deleteSuccessMessage"));
						oLocal.setProperty("/SelectedUserPath", "");
					},
					error: function(oError) {
						var response = JSON.parse(oError.responseText);
						var errorMessage = response.error.message.value;
						
						sap.m.MessageBox.alert(oBundle.getProperty("deleteErrorMessage") + errorMessage);
					}
				});
			}
		},
		/**
		 *@memberOf user_ui.user_ui.controller.UserForm
		 */
		onSelectionChange: function (oEvent) {
			//This code was generated by the layout editor.
			var oLocal = this.getView().getModel("local");
			var selectedItem = oEvent.getSource().getSelectedItem();
			var path = selectedItem.getBindingContext().getPath();
			oLocal.setProperty("/SelectedUserPath", path);
		}
	});
});